import{a as le}from"./chunk-4KXO33M5.js";import{a as se}from"./chunk-VZ6DWDHM.js";import{a as oe}from"./chunk-JONP2NBF.js";import{a as te}from"./chunk-OGQQ44XV.js";import{a as H}from"./chunk-22XSY4EJ.js";import{a as re}from"./chunk-AZJWBWL5.js";import{a as ne}from"./chunk-55FSNNZ2.js";import{c as ie}from"./chunk-6M6LJACB.js";import"./chunk-ZOJYGP6Z.js";import{c as ae}from"./chunk-U34JSWL2.js";import{a as q,c as U,e as Z,g as Q,j as J,k as Y,l as K,o as W}from"./chunk-B2HCO65P.js";import"./chunk-BPTFILPP.js";import{b as ee}from"./chunk-5N72VQB2.js";import"./chunk-VSPTT5AX.js";import{c as D,d as L,e as R,g as N,h as G,q as O,t as z,u as V,v as X}from"./chunk-BJBUZF5B.js";import{$a as c,Bb as P,Eb as B,Fb as F,Gb as u,Hb as g,Ra as l,Sa as I,V as k,_ as M,ba as $,cb as C,db as A,ga as S,gb as e,ha as b,hb as t,ia as h,ib as x,ja as w,lb as j,pb as v,qb as p,ub as n,wb as m}from"./chunk-GQGQXF3A.js";var y=V.base_url+"/ingresos-cajas",ce=(()=>{let d=class d{get getToken(){return{Authorization:localStorage.getItem("token")}}constructor(r){this.http=r}getIngresoCaja(r){return this.http.get(`${y}/${r}`,{headers:this.getToken})}listarIngresosCajas({direccion:r="desc",columna:o="id",caja:s=""}){return this.http.get(y,{params:{direccion:String(r),columna:o,caja:s},headers:this.getToken})}nuevoIngresoCaja(r){return this.http.post(y,r,{headers:this.getToken})}actualizarIngresoCaja(r,o){return this.http.patch(`${y}/${r}`,o,{headers:this.getToken})}eliminarIngresoCaja(r){return this.http.delete(`${y}/${r}`,{headers:this.getToken})}};d.\u0275fac=function(o){return new(o||d)(M(G))},d.\u0275prov=k({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();var T=V.base_url+"/gastos-cajas",me=(()=>{let d=class d{get getToken(){return{Authorization:localStorage.getItem("token")}}constructor(r){this.http=r}getGastoCaja(r){return this.http.get(`${T}/${r}`,{headers:this.getToken})}listarGastosCajas({direccion:r="desc",columna:o="id",caja:s=""}){return this.http.get(T,{params:{direccion:String(r),columna:o,caja:s},headers:this.getToken})}nuevoGastoCaja(r){return this.http.post(T,r,{headers:this.getToken})}actualizarGastoCaja(r,o){return this.http.patch(`${T}/${r}`,o,{headers:this.getToken})}eliminarGastoCaja(r){return this.http.delete(`${T}/${r}`,{headers:this.getToken})}};d.\u0275fac=function(o){return new(o||d)(M(G))},d.\u0275prov=k({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();function Ce(a,d){if(a&1&&(e(0,"option",36),n(1),t()),a&2){let i=d.$implicit;c("value",i.id),l(),m(" ",i.descripcion," ")}}function he(a,d){if(a&1){let i=j();e(0,"div",38)(1,"div",39),x(2,"img",40),e(3,"h1",41),n(4," No hay caja activa "),t(),e(5,"button",42),v("click",function(){S(i);let o=p(2);return b(o.activarCaja())}),n(6," Activar nueva caja "),t()()()}}function xe(a,d){if(a&1){let i=j();h(),w(),e(0,"button",87),v("click",function(){S(i);let o=p(3);return b(o.abrirCierreCaja())}),h(),e(1,"svg",49),x(2,"path",88),t()()}}function fe(a,d){if(a&1&&(e(0,"div",89),n(1),u(2,"moneda"),t()),a&2){let i=p(3);l(),m(" $",g(2,1,i.saldoInicial)," ")}}function Se(a,d){if(a&1){let i=j();e(0,"input",90),v("keyup.enter",function(){S(i);let o=p(3);return b(o.editarSaldoInicial())})("ngModelChange",function(o){S(i);let s=p(3);return b(s.saldoInicialTMP=o)}),t()}if(a&2){let i=p(3);c("ngModel",i.saldoInicialTMP)}}function be(a,d){if(a&1){let i=j();e(0,"button",93),v("click",function(){S(i);let o=p(5);return b(o.abrirEditarSaldoInicial())}),h(),e(1,"svg",49),x(2,"path",94),t()()}}function je(a,d){if(a&1&&(e(0,"div"),C(1,be,3,0,"button",92),t()),a&2){let i=p(4);l(),c("ngIf",i.authService.usuario.role==="ADMIN_ROLE")}}function Ie(a,d){if(a&1&&C(0,je,2,1,"div",91),a&2){let i=p(3);c("appPermisos",i.permiso_escritura)}}function we(a,d){if(a&1){let i=j();e(0,"div",95)(1,"button",96),v("click",function(){S(i);let o=p(3);return b(o.editarSaldoInicial())}),h(),e(2,"svg",49),x(3,"path",88),t()(),w(),e(4,"button",97),v("click",function(){S(i);let o=p(3);return b(o.cerrarEditarSaldoInicial())}),h(),e(5,"svg",49),x(6,"path",98),t()()()}}function Ee(a,d){if(a&1&&(e(0,"div",99)(1,"p"),n(2," Guia de despacho "),t(),e(3,"p",100),n(4),u(5,"moneda"),t()()),a&2){let i=p(3);l(4),m(" $",g(5,1,i.totales==null?null:i.totales.totalFacturado)," ")}}function ye(a,d){if(a&1&&(e(0,"div",101)(1,"p"),n(2," Factura A "),t(),e(3,"p",102),n(4),u(5,"moneda"),t()()),a&2){let i=p(3);l(4),m(" $",g(5,1,i.totales==null?null:i.totales.totalFacturadoTipoA)," ")}}function Te(a,d){if(a&1&&(e(0,"div",103)(1,"p"),n(2," Total "),t(),e(3,"p",104),n(4),u(5,"moneda"),t()()),a&2){let i=p(3);l(4),m(" $",g(5,1,(i.totales==null?null:i.totales.totalFacturadoTipoA)+(i.totales==null?null:i.totales.totalFacturado))," ")}}function ke(a,d){a&1&&(h(),e(0,"svg",67),x(1,"path",105),t())}function Me(a,d){a&1&&(h(),e(0,"svg",67),x(1,"path",106),t())}function Ge(a,d){if(a&1&&(e(0,"div",107)(1,"div",62)(2,"div",63)(3,"span",76),n(4," (-) "),t(),e(5,"p",65),n(6," Debito "),t()(),e(7,"p",77),n(8),u(9,"moneda"),t()(),e(10,"div",62)(11,"div",63)(12,"span",76),n(13," (-) "),t(),e(14,"p",65),n(15," Credito "),t()(),e(16,"p",77),n(17),u(18,"moneda"),t()(),e(19,"div",62)(20,"div",63)(21,"span",76),n(22," (-) "),t(),e(23,"p",65),n(24," MercadoPago "),t()(),e(25,"p",77),n(26),u(27,"moneda"),t()()()),a&2){let i=p(3);l(8),m(" -$",g(9,3,i.totales==null?null:i.totales.totalDebito)," "),l(9),m(" -$",g(18,5,i.totales==null?null:i.totales.totalCredito)," "),l(9),m(" -$",g(27,7,i.totales==null?null:i.totales.totalMercadoPago)," ")}}function Ve(a,d){if(a&1){let i=j();e(0,"button",108),v("click",function(){S(i);let o=p(3);return b(o.abrirIngresoGasto())}),h(),e(1,"svg",49),x(2,"path",109),t()()}}function Ae(a,d){a&1&&(h(),e(0,"svg",115),x(1,"path",105),t())}function $e(a,d){a&1&&(h(),e(0,"svg",115),x(1,"path",106),t())}function Pe(a,d){if(a&1&&(e(0,"p",119),n(1),t()),a&2){let i=p().$implicit;l(),m(" ",i.descripcion," ")}}function Be(a,d){if(a&1){let i=j();e(0,"div",117),v("click",function(){let s=S(i).$implicit,_=p(5);return b(_.permisosAll&&_.eliminarIngreso(s.id))}),e(1,"div")(2,"p",9)(3,"span",114),n(4," (+) "),t(),n(5),t(),C(6,Pe,2,1,"p",118),t(),e(7,"p"),n(8),u(9,"moneda"),t()()}if(a&2){let i=d.$implicit;l(5),m(" ",i.tipoIngreso.descripcion," "),l(),c("ngIf",i.descripcion),l(2),m(" $",g(9,3,i.monto)," ")}}function Fe(a,d){if(a&1&&(e(0,"div"),C(1,Be,10,5,"div",116),t()),a&2){let i=p(4);l(),c("ngForOf",i.ingresos)}}function De(a,d){if(a&1){let i=j();e(0,"div")(1,"div",110),v("click",function(){S(i);let o=p(3);return b(o.showIngresos=!o.showIngresos)}),e(2,"h3"),n(3," Listado de ingresos "),t(),e(4,"div"),C(5,Ae,2,0,"svg",111)(6,$e,2,0,"svg",111),t()(),C(7,Fe,2,1,"div",35),e(8,"div",112)(9,"p",113)(10,"span",114),n(11," (+) "),t(),n(12," Total ingresos "),t(),e(13,"p"),n(14),u(15,"moneda"),t()()()}if(a&2){let i=p(3);l(5),c("ngIf",i.showIngresos),l(),c("ngIf",!i.showIngresos),l(),c("ngIf",i.showIngresos),l(7),m(" $",g(15,4,i.totalIngresos)," ")}}function Le(a,d){a&1&&(h(),e(0,"svg",115),x(1,"path",105),t())}function Re(a,d){a&1&&(h(),e(0,"svg",115),x(1,"path",106),t())}function Ne(a,d){if(a&1&&(e(0,"p",119),n(1),t()),a&2){let i=p().$implicit;l(),m(" ",i.descripcion," ")}}function Oe(a,d){if(a&1){let i=j();e(0,"div",117),v("click",function(){let s=S(i).$implicit,_=p(5);return b(_.permisosAll&&_.eliminarGasto(s.id))}),e(1,"div")(2,"p",9)(3,"span",122),n(4," (-) "),t(),n(5),t(),C(6,Ne,2,1,"p",118),t(),e(7,"p"),n(8),u(9,"moneda"),t()()}if(a&2){let i=d.$implicit;l(5),m(" ",i.tipoGasto.descripcion," "),l(),c("ngIf",i.descripcion),l(2),m(" -$",g(9,3,i.monto)," ")}}function ze(a,d){if(a&1&&(e(0,"div"),C(1,Oe,10,5,"div",116),t()),a&2){let i=p(4);l(),c("ngForOf",i.gastos)}}function He(a,d){if(a&1){let i=j();e(0,"div")(1,"div",120),v("click",function(){S(i);let o=p(3);return b(o.showGastos=!o.showGastos)}),e(2,"h3"),n(3," Listado de gastos "),t(),e(4,"div"),C(5,Le,2,0,"svg",111)(6,Re,2,0,"svg",111),t()(),C(7,ze,2,1,"div",35),e(8,"div",121)(9,"p",113)(10,"span",122),n(11," (-) "),t(),n(12," Total gastos "),t(),e(13,"p"),n(14),u(15,"moneda"),t()()()}if(a&2){let i=p(3);l(5),c("ngIf",i.showGastos),l(),c("ngIf",!i.showGastos),l(),c("ngIf",i.showGastos),l(7),m(" -$",g(15,4,i.totalGastos)," ")}}function qe(a,d){a&1&&(e(0,"div")(1,"p",123),n(2," No se encontraron elementos cargados "),t()())}function Ue(a,d){if(a&1){let i=j();e(0,"div",43)(1,"div",44)(2,"div",45)(3,"div",46)(4,"h1",47),n(5),t(),e(6,"div")(7,"button",48),h(),e(8,"svg",49),x(9,"path",50),t()(),C(10,xe,3,0,"button",51),t()(),w(),e(11,"div",52)(12,"div")(13,"div",53)(14,"div",54)(15,"h2",55),n(16," Fecha de caja "),t(),e(17,"input",56),v("ngModelChange",function(o){S(i);let s=p(2);return b(s.fechaCaja=o)}),t()(),e(18,"div",57)(19,"h2",58),n(20," Saldo inicial "),t(),C(21,fe,3,3,"div",59)(22,Se,1,1,"input",60),t(),C(23,Ie,1,1,"div")(24,we,7,0),t()()(),e(25,"div",52)(26,"div",61)(27,"p"),n(28," Cantidad de ventas "),t(),e(29,"p",9),n(30),t()(),e(31,"div",62)(32,"div",63)(33,"span",64),n(34," (+) "),t(),e(35,"p",65),n(36," Total balanza "),t()(),e(37,"p"),n(38),u(39,"moneda"),t()(),e(40,"div",62)(41,"div",63)(42,"span",64),n(43," (+) "),t(),e(44,"p",65),n(45," Total no balanza "),t()(),e(46,"p"),n(47),u(48,"moneda"),t()(),e(49,"div",62)(50,"div",63)(51,"span",64),n(52," (+) "),t(),e(53,"p",65),n(54," Total adicional por credito "),t()(),e(55,"p"),n(56),u(57,"moneda"),t()(),e(58,"div",62)(59,"div",63)(60,"span",66),h(),e(61,"svg",67),x(62,"path",68),t()(),w(),e(63,"p",69),n(64," Total adelantos de reservas "),t()(),e(65,"p"),n(66),u(67,"moneda"),t()(),e(68,"div",62)(69,"div",63)(70,"span",70),h(),e(71,"svg",67),x(72,"path",68),t()(),w(),e(73,"p",69),n(74," Total completar reservas "),t()(),e(75,"p"),n(76),u(77,"moneda"),t()(),e(78,"div",71),v("click",function(){S(i);let o=p(2);return b(o.showTotalFacturado=!o.showTotalFacturado)}),e(79,"div",72)(80,"p"),n(81," Total en ventas "),t(),e(82,"p",9),n(83),u(84,"moneda"),t()(),C(85,Ee,6,3,"div",73)(86,ye,6,3,"div",74)(87,Te,6,3,"div",75),t(),e(88,"div",62)(89,"div",63)(90,"span",64),n(91," (+) "),t(),e(92,"p",65),n(93," Saldo inicial de caja "),t()(),e(94,"p"),n(95),u(96,"moneda"),t()(),e(97,"div",62)(98,"div",63)(99,"span",64),n(100," (+) "),t(),e(101,"p",65),n(102," Otros ingresos "),t()(),e(103,"p"),n(104),u(105,"moneda"),t()(),e(106,"div",62)(107,"div",63)(108,"span",76),n(109," (-) "),t(),e(110,"p",65),n(111," Otros gastos "),t()(),e(112,"p",77),n(113),u(114,"moneda"),t()(),e(115,"div",62)(116,"div",63)(117,"span",76),n(118," (-) "),t(),e(119,"p",65),n(120," PedidosYa - Online "),t()(),e(121,"p",77),n(122),u(123,"moneda"),t()(),e(124,"div",78),v("click",function(){S(i);let o=p(2);return b(o.showModalPostnet=!o.showModalPostnet)}),e(125,"div",63)(126,"span",76),n(127," (-) "),t(),e(128,"p",65),n(129," Total postnet "),t(),e(130,"div",79),C(131,ke,2,0,"svg",80)(132,Me,2,0,"svg",80),t()(),e(133,"p",77),n(134),u(135,"moneda"),t()(),C(136,Ge,28,9,"div",81),e(137,"div",82)(138,"p"),n(139," Total efectivo en caja (Sistema) "),t(),e(140,"p",9),n(141),u(142,"moneda"),t()()()(),e(143,"div",83)(144,"div",84)(145,"h2",85),n(146," Ingresos y gastos "),t(),C(147,Ve,3,0,"button",86),t(),e(148,"div",52),C(149,De,16,6,"div",35)(150,He,16,6,"div",35)(151,qe,3,0,"div",35),t()()()()}if(a&2){let i=p(2);l(5),m(" Cierre de caja - Nro ",i.idCaja," "),l(5),c("appPermisos",i.permiso_escritura),l(7),c("disabled",!i.permisosAll)("ngModel",i.fechaCaja),l(4),c("ngIf",!i.showEditarSaldoInicial),l(),c("ngIf",i.showEditarSaldoInicial),l(),A(23,i.showEditarSaldoInicial?24:23),l(7),m(" ",i.totales==null?null:i.totales.cantidadVentas," "),l(8),m(" $",g(39,30,i.totales==null?null:i.totales.totalBalanza)," "),l(9),m(" $",g(48,32,i.totales==null?null:i.totales.totalNoBalanza)," "),l(9),m(" $",g(57,34,i.totales==null?null:i.totales.totalAdicionalCredito)," "),l(10),m(" $",g(67,36,i.totales==null?null:i.totales.totalAdelantoReserva)," "),l(10),m(" $",g(77,38,i.totales==null?null:i.totales.totalCompletarReserva)," "),l(7),m(" $",g(84,40,i.totales==null?null:i.totales.totalVentas)," "),l(2),c("ngIf",i.showTotalFacturado),l(),c("ngIf",i.showTotalFacturado),l(),c("ngIf",i.showTotalFacturado),l(8),m(" $",g(96,42,i.saldoInicial)," "),l(9),m(" $",g(105,44,i.totales==null?null:i.totales.totalIngresos)," "),l(9),m(" -$",g(114,46,i.totales==null?null:i.totales.totalGastos)," "),l(9),m(" -$",g(123,48,i.totales==null?null:i.totales.totalPedidosYaOnline)," "),l(9),c("ngIf",i.showModalPostnet),l(),c("ngIf",!i.showModalPostnet),l(2),m(" -$",g(135,50,i.totales==null?null:i.totales.totalPostnet)," "),l(2),c("ngIf",i.showModalPostnet),l(5),m(" $",g(142,52,i.totales==null?null:i.totales.totalEfectivoEnCaja)," "),l(6),c("appPermisos",i.permiso_escritura),l(2),c("ngIf",i.ingresos.length>0),l(),c("ngIf",i.gastos.length>0),l(),c("ngIf",i.ingresos.length===0&&i.gastos.length===0)}}function Ze(a,d){if(a&1&&(e(0,"div"),C(1,he,7,0,"div",37)(2,Ue,152,54),t()),a&2){let i=p();l(),A(1,i.idCaja?2:1)}}var Qe=(a,d,i)=>({"text-red-700":a,"text-black":d,"text-green-700":i}),Je=(a,d)=>({"boton-crear":a,"boton-eliminar":d}),xt=(()=>{let d=class d{constructor(r,o,s,_,f,E,pe,_e){this.alertService=r,this.authService=o,this.dataService=s,this.tiposIngresos=_,this.tiposGastos=f,this.ingresosService=E,this.gastosService=pe,this.cajasService=_e,this.permiso_escritura=["CIERRE_CAJA_ALL"],this.permisosAll=!1,this.showModalPostnet=!1,this.showModalIngresoGasto=!1,this.showModalCerrarCaja=!1,this.iniciando=!0,this.saldoInicialTMP=0,this.showEditarSaldoInicial=!1,this.showTotalFacturado=!1,this.showIngresos=!0,this.showGastos=!0,this.idCaja=null,this.saldoInicial=0,this.totales={},this.totalIngresos=0,this.totalGastos=0,this.ingresos=[],this.gastos=[],this.tipos=[],this.dataIngresoGasto={ingresoGasto:"gasto",tipoId:"",tipoDescripcion:"",monto:null,descripcion:""},this.fechaCaja=ie(new Date,"yyyy-MM-dd"),this.totalEfectivoCajaReal=null,this.montoTesoreria=null,this.diferenciaCaja=0,this.saldoProximaCaja=0}ngOnInit(){this.dataService.ubicacionActual=" Dashboard - Cierre de caja",this.cargaInicial()}cargaInicial(){this.alertService.loading(),this.verificacionPermisosTotales(),this.cajasService.listarCajas({activo:"true"}).subscribe({next:({cajas:r})=>{this.idCaja=r[0]?r[0].id:null,r[0]?(this.saldoInicial=r[0].saldoInicial?r[0].saldoInicial:0,this.saldoInicialTMP=r[0].saldoInicial?r[0].saldoInicial:0,this.getCaja()):this.alertService.close(),this.iniciando=!1},error:({error:r})=>this.alertService.errorApi(r.message)})}verificacionPermisosTotales(){this.permisosAll=this.authService.usuario.permisos.includes("CIERRE_CAJA_ALL")||this.authService.usuario.role==="ADMIN_ROLE"}getCaja(){this.cajasService.getTotalesActivos(this.idCaja).subscribe({next:({totales:r,ingresos:o,gastos:s})=>{this.saldoInicial=r.saldoInicial,this.ingresos=o,this.totales=r,this.gastos=s,this.totalIngresos=r.totalIngresos,this.totalGastos=r.totalGastos,this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)})}abrirIngresoGasto(){this.reiniciarIngresoGasto(),this.alertService.loading(),this.dataIngresoGasto.ingresoGasto==="ingreso"?this.tiposIngresos.listarTipos({activo:"true"}).subscribe({next:({tipos:r})=>{this.tipos=r,this.showModalIngresoGasto=!0,this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)}):this.tiposGastos.listarTipos({activo:"true"}).subscribe({next:({tipos:r})=>{this.tipos=r,this.showModalIngresoGasto=!0,this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)})}cambiarTipoIngresoGasto(){this.alertService.loading(),this.dataIngresoGasto.ingresoGasto==="ingreso"?this.tiposIngresos.listarTipos({activo:"true"}).subscribe({next:({tipos:r})=>{this.tipos=r,this.dataIngresoGasto.tipoId="",this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)}):this.tiposGastos.listarTipos({activo:"true"}).subscribe({next:({tipos:r})=>{this.tipos=r,this.dataIngresoGasto.tipoId="",this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)})}agregarIngresoGasto(){let{ingresoGasto:r,tipoId:o,monto:s,descripcion:_}=this.dataIngresoGasto;if(o===""){this.alertService.info("Debes seleccionar un tipo");return}if(s<=0){this.alertService.info("Debes ingresar un monto valido");return}if(_===""){this.alertService.info("Debes ingresar una descripcion");return}if(this.alertService.loading(),r==="ingreso"){let f={tipoIngresoId:Number(o),monto:s,cajaId:Number(this.idCaja),descripcion:_,creatorUserId:this.authService.usuario.userId};this.ingresosService.nuevoIngresoCaja(f).subscribe({next:()=>{this.showModalIngresoGasto=!1,this.reiniciarIngresoGasto(),this.getCaja()},error:({error:E})=>this.alertService.errorApi(E.message)})}else{let f={tipoGastoId:Number(o),monto:s,cajaId:Number(this.idCaja),descripcion:_,creatorUserId:this.authService.usuario.userId};this.gastosService.nuevoGastoCaja(f).subscribe({next:()=>{this.showModalIngresoGasto=!1,this.reiniciarIngresoGasto(),this.getCaja()},error:({error:E})=>this.alertService.errorApi(E.message)})}}eliminarIngreso(r){this.alertService.question({msg:"\xBFQuieres eliminar el ingreso?",buttonText:"Eliminar"}).then(({isConfirmed:o})=>{o&&(this.alertService.loading(),this.ingresosService.eliminarIngresoCaja(r).subscribe({next:()=>{this.getCaja()},error:({error:s})=>this.alertService.errorApi(s.message)}))})}eliminarGasto(r){this.alertService.question({msg:"\xBFQuieres eliminar el gasto?",buttonText:"Eliminar"}).then(({isConfirmed:o})=>{o&&(this.alertService.loading(),this.gastosService.eliminarGastoCaja(r).subscribe({next:()=>{this.getCaja()},error:({error:s})=>this.alertService.errorApi(s.message)}))})}activarCaja(){this.alertService.question({msg:"Estas por activar una caja",buttonText:"Activar"}).then(({isConfirmed:r})=>{r&&(this.alertService.loading(),this.cajasService.nuevaCaja({creatorUserId:this.authService.usuario.userId}).subscribe({next:({caja:o})=>{this.idCaja=o.id,this.saldoInicial=o.saldoInicial,this.saldoInicialTMP=o.saldoInicial,this.getCaja()},error:({error:o})=>this.alertService.errorApi(o.message)}))})}abrirEditarSaldoInicial(){this.saldoInicialTMP=this.saldoInicial,this.showEditarSaldoInicial=!0}cerrarEditarSaldoInicial(){this.showEditarSaldoInicial=!1}abrirCierreCaja(){this.totalEfectivoCajaReal=null,this.montoTesoreria=null,this.diferenciaCaja=0,this.saldoProximaCaja=0,this.showModalCerrarCaja=!0}editarSaldoInicial(){if(this.saldoInicialTMP===null||this.saldoInicialTMP<0){this.alertService.info("Debes ingresar un saldo inicial valido");return}this.alertService.question({msg:"\xBFQuieres editar el saldo inicial?",buttonText:"Actualizar"}).then(({isConfirmed:r})=>{r&&(this.alertService.loading(),this.cajasService.actualizarCaja(this.idCaja,{saldoInicial:this.saldoInicialTMP}).subscribe({next:({caja:o})=>{this.saldoInicial=o.saldoInicial,this.saldoInicialTMP=o.saldoInicial,this.showEditarSaldoInicial=!1,this.getCaja()},error:({error:o})=>this.alertService.errorApi(o.message)}))})}calcularCierreCaja(){this.diferenciaCaja=this.totalEfectivoCajaReal-this.totales?.totalEfectivoEnCaja,this.saldoProximaCaja=this.totalEfectivoCajaReal-this.montoTesoreria}completarCierreCaja(){if(this.fechaCaja===null||this.fechaCaja===""){this.alertService.info("Debes ingresar una fecha de caja valida");return}if(this.totalEfectivoCajaReal===null||this.totalEfectivoCajaReal<0){this.alertService.info("Debes ingresar un total de efectivo valido");return}if(this.montoTesoreria===null||this.montoTesoreria<0){this.alertService.info("Debes ingresar un monto de tesoreria valido");return}if(this.totales?.cantidadVentas<=0){this.alertService.info("Debes tener al menos una venta en caja");return}this.alertService.question({msg:"Completando cierre de caja",buttonText:"Completar"}).then(({isConfirmed:r})=>{r&&(this.alertService.loading(),this.cajasService.completarCaja(this.idCaja,{totalEfectivoCajaReal:this.totalEfectivoCajaReal,tesoreria:this.montoTesoreria,fechaCaja:this.fechaCaja,creatorUserId:this.authService.usuario.userId}).subscribe({next:({caja:o})=>{this.idCaja=o.id,this.showModalCerrarCaja=!1,this.getCaja()},error:({error:o})=>this.alertService.errorApi(o.message)}))})}reiniciarIngresoGasto(){this.dataIngresoGasto={ingresoGasto:"gasto",tipoId:"",tipoDescripcion:"",monto:null,descripcion:""}}};d.\u0275fac=function(o){return new(o||d)(I(X),I(H),I(ee),I(oe),I(le),I(ce),I(me),I(se))},d.\u0275cmp=$({type:d,selectors:[["app-cierre-caja"]],standalone:!0,features:[P],decls:86,vars:31,consts:[[3,"showModal"],[1,"flex","items-center","justify-between","bg-gray-800","rounded-t","p-2"],[1,"text-white","px-2","py-1","rounded-t","text-lg"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"cursor-pointer","feather","feather-x","text-white","mr-2",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"text-sm","p-4"],[1,"max-h-96","overflow-y-auto"],[1,"bg-gray-50","px-2","py-4","flex","items-center","justify-between","border","border-gray-400","w-full","rounded"],[1,"font-semibold"],[1,"bg-gray-50","p-2","mt-2","flex","items-center","justify-between","border","border-gray-400","w-full","rounded"],["type","number","placeholder","Ej. 120000",1,"input-generico",3,"ngModel","keyup","ngModelChange"],["type","number","placeholder","Ej. 50000",1,"input-generico",3,"ngModel","keyup","ngModelChange"],[1,"bg-gray-50","px-2","mt-2","py-4","flex","items-center","justify-between","border","border-gray-400","w-full","rounded"],[1,"font-semibold",3,"ngClass"],[1,"md:flex","md:items-center","w-full","mt-3"],[1,"md:w-1/2","w-full","boton-crear",3,"click"],[1,"md:w-1/2","md:ml-2","mt-2","md:mt-0","w-full","boton-eliminar",3,"click"],[1,"p-4","text-sm"],[1,"w-full","md:flex","md:items-center"],[1,"md:w-1/2"],[1,"text-red-500"],[1,"input-generico","w-full","mt-2",3,"ngModel","change","ngModelChange"],["value","ingreso"],["value","gasto"],[1,"md:w-1/2","md:ml-2","mt-4","md:mt-0"],[1,"input-generico","w-full","mt-2",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"px-4","pb-4","text-sm"],["type","number","placeholder","Ej. 3000",1,"input-generico","w-full","mt-2",3,"ngModel","keyup.enter","ngModelChange"],[1,"md:w-1/2","mt-4","md:mt-0","md:ml-2"],["type","text","placeholder","Ej. Descripcion obligatoria",1,"input-generico","w-full","mt-2",3,"ngModel","keyup.enter","ngModelChange"],[1,"px-4","pb-2"],[1,"w-full",3,"ngClass","click"],[4,"ngIf"],[3,"value"],["class","w-full flex items-center justify-center mt-5"],[1,"w-full","flex","items-center","justify-center","mt-5"],[1,"text-center"],["src","assets/svg/cajas.svg","alt","cajas.svg",1,"w-1/2","mx-auto","mb-7"],[1,"text-4xl","font-semibold"],[1,"bg-secondaryColor","hover:opacity-90","mt-10","text-white","p-4","rounded",3,"click"],[1,"text-sm","mb-10"],[1,"md:flex","md:justify-center","w-11/12","mx-auto","mt-4","md:px-10"],[1,"md:w-1/2","w-full","border","border-gray-400","rounded-t"],[1,"bg-gray-800","border","border-gray-900","p-2","flex","items-center","justify-between"],[1,"text-white","text-lg","rounded-t"],["title","Ventas en caja","routerLink","/dashboard/ventas-activas",1,"bg-gray-50","p-2","rounded","hover:text-secondaryColor"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"],["title","Cerrar caja","class","boton-crear ml-2",3,"click",4,"appPermisos"],[1,"p-2"],[1,"flex","items-center","justify-center","w-full"],[1,"text-center","w-1/2"],[1,"font-semibold","mr-4"],["type","date",1,"input-generico","text-center","w-full","mr-4","mt-2",3,"disabled","ngModel","ngModelChange"],[1,"w-1/2","mr-1"],[1,"text-gray-900","text-center","font-semibold"],["class","bg-gray-100 ml-2 border text-center w-full mt-2 border-gray-400 p-2 rounded",4,"ngIf"],["type","number","placeholder","Ej. 2000","class","input-generico text-center w-full mt-2 ml-2",3,"ngModel","keyup.enter","ngModelChange",4,"ngIf"],[1,"p-2","flex","items-center","justify-between","bg-gray-100","border","border-gray-400"],[1,"flex","items-center","p-2","mt-1","justify-between"],[1,"flex","items-center"],[1,"text-green-600","font-semibold"],[1,"ml-1"],[1,"p-1","rounded-full","text-yellow-700","bg-yellow-100","border","border-yellow-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],[1,"ml-2"],[1,"p-1","rounded-full","text-green-700","bg-green-100","border","border-green-400"],[1,"p-2","mt-1","cursor-pointer","bg-gray-100","border","border-gray-400",3,"click"],[1,"flex","items-center","justify-between"],["class","flex bg-purple-50 text-sm border mt-2 border-purple-400 p-2 items-center justify-between",4,"ngIf"],["class","flex bg-orange-50 text-sm border mt-2 border-orange-400 p-2 items-center justify-between",4,"ngIf"],["class","flex bg-green-50 text-sm border mt-2 border-green-400 p-2 items-center justify-between",4,"ngIf"],[1,"text-red-600","font-semibold"],[1,"text-red-600"],[1,"flex","items-center","cursor-pointer","px-2","py-1","mt-1","justify-between",3,"click"],[1,"ml-2","p-1","bg-gray-100","rounded-full","border","border-gray-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor","class","w-3 h-3",4,"ngIf"],["class","bg-red-50 p-2 text-sm border mb-2 border-red-300",4,"ngIf"],[1,"p-2","flex","items-center","mt-1","justify-between","bg-gray-100","border","border-gray-400"],[1,"md:w-1/2","md:ml-3","border","w-full","mt-3","md:mt-0","h-max","border-gray-400"],[1,"p-2","flex","items-center","justify-between","bg-gray-800","text-white"],[1,"text-lg"],["title","Agregar elemento","class","boton-crear",3,"click",4,"appPermisos"],["title","Cerrar caja",1,"boton-crear","ml-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","m4.5 12.75 6 6 9-13.5"],[1,"bg-gray-100","ml-2","border","text-center","w-full","mt-2","border-gray-400","p-2","rounded"],["type","number","placeholder","Ej. 2000",1,"input-generico","text-center","w-full","mt-2","ml-2",3,"ngModel","keyup.enter","ngModelChange"],[4,"appPermisos"],["title","Editar saldo inicial","class","ml-4 p-2 border border-gray-400 shadow mt-7 rounded bg-gray-50 hover:text-secondaryColor",3,"click",4,"ngIf"],["title","Editar saldo inicial",1,"ml-4","p-2","border","border-gray-400","shadow","mt-7","rounded","bg-gray-50","hover:text-secondaryColor",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"],[1,"flex","items-center","ml-2"],["title","Actualizar",1,"p-2","bg-green-700","w-max","rounded-full","hover:opacity-90","text-white","mt-6","ml-2",3,"click"],["title","Cancelar",1,"p-2","bg-red-700","w-max","rounded-full","hover:opacity-90","text-white","mt-6","ml-1",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18 18 6M6 6l12 12"],[1,"flex","bg-purple-50","text-sm","border","mt-2","border-purple-400","p-2","items-center","justify-between"],[1,"font-semibold","text-purple-800"],[1,"flex","bg-orange-50","text-sm","border","mt-2","border-orange-400","p-2","items-center","justify-between"],[1,"font-semibold","text-orange-800"],[1,"flex","bg-green-50","text-sm","border","mt-2","border-green-400","p-2","items-center","justify-between"],[1,"font-semibold","text-green-800"],["stroke-linecap","round","stroke-linejoin","round","d","m19.5 8.25-7.5 7.5-7.5-7.5"],["stroke-linecap","round","stroke-linejoin","round","d","m4.5 15.75 7.5-7.5 7.5 7.5"],[1,"bg-red-50","p-2","text-sm","border","mb-2","border-red-300"],["title","Agregar elemento",1,"boton-crear",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4.5v15m7.5-7.5h-15"],[1,"bg-green-100","flex","items-center","justify-between","cursor-pointer","p-2","border","border-green-300",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor","class","w-4 h-4",4,"ngIf"],[1,"flex","font-semibold","items-center","justify-between","px-2","mb-4","mt-1"],[1,"mt-2"],[1,"font-semibold","text-green-600"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-4","h-4"],["class","flex items-center hover:bg-purple-100 cursor-pointer border-b border-b-300 justify-between mt-2 p-2",3,"click",4,"ngFor","ngForOf"],[1,"flex","items-center","hover:bg-purple-100","cursor-pointer","border-b","border-b-300","justify-between","mt-2","p-2",3,"click"],["class","text-gray-500 uppercase text-xs mt-1",4,"ngIf"],[1,"text-gray-500","uppercase","text-xs","mt-1"],[1,"flex","items-center","bg-red-100","cursor-pointer","justify-between","p-2","border","border-red-300",3,"click"],[1,"flex","font-semibold","items-center","justify-between","mb-4","mt-1","px-2"],[1,"font-semibold","text-red-600"],[1,"text-gray-500","italic","text-center","py-2"]],template:function(o,s){o&1&&(e(0,"app-modal",0)(1,"div",1)(2,"h1",2),n(3," Cerrando caja "),t(),h(),e(4,"svg",3),v("click",function(){return s.showModalCerrarCaja=!1}),x(5,"line",4)(6,"line",5),t()(),w(),e(7,"div",6)(8,"div",7)(9,"div",8)(10,"p"),n(11," Total efectivo en caja (Sistema) "),t(),e(12,"p",9),n(13),u(14,"moneda"),t()(),e(15,"div",10)(16,"p"),n(17," Total efectivo en caja (Real) "),t(),e(18,"input",11),v("keyup",function(){return s.calcularCierreCaja()})("ngModelChange",function(f){return s.totalEfectivoCajaReal=f}),t()(),e(19,"div",10)(20,"p"),n(21," Monto tesoreria "),t(),e(22,"input",12),v("keyup",function(){return s.calcularCierreCaja()})("ngModelChange",function(f){return s.montoTesoreria=f}),t()(),e(23,"div",13)(24,"p"),n(25," Diferencia en caja "),t(),e(26,"p",14),n(27),u(28,"moneda"),t()(),e(29,"div",13)(30,"p"),n(31," Saldo inicial proxima caja "),t(),e(32,"p",9),n(33),u(34,"moneda"),t()()(),e(35,"div",15)(36,"button",16),v("click",function(){return s.completarCierreCaja()}),n(37," Completar "),t(),e(38,"button",17),v("click",function(){return s.showModalCerrarCaja=!1}),n(39," Cancelar "),t()()()(),e(40,"app-modal",0)(41,"div",1)(42,"h1",2),n(43),t(),h(),e(44,"svg",3),v("click",function(){return s.showModalIngresoGasto=!1}),x(45,"line",4)(46,"line",5),t()(),w(),e(47,"div",18)(48,"div",19)(49,"div",20)(50,"p",9)(51,"span",21),n(52," * "),t(),n(53," Ingreso - Gasto "),t(),e(54,"select",22),v("change",function(){return s.cambiarTipoIngresoGasto()})("ngModelChange",function(f){return s.dataIngresoGasto.ingresoGasto=f}),e(55,"option",23),n(56," Ingreso "),t(),e(57,"option",24),n(58," Gasto "),t()()(),e(59,"div",25)(60,"p",9)(61,"span",21),n(62," * "),t(),n(63),t(),e(64,"select",26),v("ngModelChange",function(f){return s.dataIngresoGasto.tipoId=f}),e(65,"option",27),n(66," Seleccionar tipo "),t(),C(67,Ce,2,2,"option",28),t()()()(),e(68,"div",29)(69,"div",19)(70,"div",20)(71,"p",9)(72,"span",21),n(73," * "),t(),n(74," Monto "),t(),e(75,"input",30),v("keyup.enter",function(){return s.agregarIngresoGasto()})("ngModelChange",function(f){return s.dataIngresoGasto.monto=f}),t()(),e(76,"div",31)(77,"p",9)(78,"span",21),n(79," * "),t(),n(80," Descripcion "),t(),e(81,"input",32),v("keyup.enter",function(){return s.agregarIngresoGasto()})("ngModelChange",function(f){return s.dataIngresoGasto.descripcion=f}),t()()()(),e(82,"div",33)(83,"button",34),v("click",function(){return s.agregarIngresoGasto()}),n(84),t()()(),C(85,Ze,3,1,"div",35)),o&2&&(c("showModal",s.showModalCerrarCaja),l(13),m(" $",g(14,18,s.totales==null?null:s.totales.totalEfectivoEnCaja)," "),l(5),c("ngModel",s.totalEfectivoCajaReal),l(4),c("ngModel",s.montoTesoreria),l(4),c("ngClass",F(24,Qe,s.diferenciaCaja<0,s.diferenciaCaja===0,s.diferenciaCaja>0)),l(),m(" $",g(28,20,s.diferenciaCaja)," "),l(6),m(" $",g(34,22,s.saldoProximaCaja)," "),l(7),c("showModal",s.showModalIngresoGasto),l(3),m(" Agregando ",s.dataIngresoGasto.ingresoGasto," "),l(11),c("ngModel",s.dataIngresoGasto.ingresoGasto),l(9),m(" Tipo de ",s.dataIngresoGasto.ingresoGasto," "),l(),c("ngModel",s.dataIngresoGasto.tipoId),l(3),c("ngForOf",s.tipos),l(8),c("ngModel",s.dataIngresoGasto.monto),l(6),c("ngModel",s.dataIngresoGasto.descripcion),l(2),c("ngClass",B(28,Je,s.dataIngresoGasto.ingresoGasto==="ingreso",s.dataIngresoGasto.ingresoGasto==="gasto")),l(),m(" Agregar ",s.dataIngresoGasto.ingresoGasto," "),l(),c("ngIf",!s.iniciando))},dependencies:[N,D,L,R,W,Y,K,q,Q,J,U,Z,ne,ae,z,O,re,te],encapsulation:2});let a=d;return a})();export{xt as default};
