import{a as se,b as N}from"./chunk-LQQHBQB6.js";import{a as ce,b as de}from"./chunk-L5BLIFW3.js";import{a as U}from"./chunk-22XSY4EJ.js";import{a as F,b as me}from"./chunk-H74VPA6E.js";import{a as le}from"./chunk-AZJWBWL5.js";import{a as ne}from"./chunk-55FSNNZ2.js";import{d as ae}from"./chunk-6M6LJACB.js";import"./chunk-UQYYX3ZV.js";import"./chunk-ZOJYGP6Z.js";import{c as re}from"./chunk-U34JSWL2.js";import{a as Z,c as J,e as R,g as Q,j as q,k as K,l as W,m as X,o as ee}from"./chunk-B2HCO65P.js";import{a as te}from"./chunk-BPTFILPP.js";import{b as oe}from"./chunk-5N72VQB2.js";import"./chunk-VSPTT5AX.js";import{c as D,d as G,e as $,g as O,t as H,u as Y,v as ie}from"./chunk-BJBUZF5B.js";import{$a as m,Bb as j,Eb as A,Gb as P,Hb as V,Jb as z,Ra as l,Sa as T,ba as L,cb as S,db as B,eb as I,fb as M,ga as g,gb as t,ha as h,hb as i,ia as v,ib as x,ja as C,lb as b,pb as u,qb as d,ub as c,wb as _,xb as E}from"./chunk-GQGQXF3A.js";var pe=[{descripcion:"CUIL"},{descripcion:"CUIT"}];var ge=(n,s)=>s.id;function he(n,s){if(n&1){let e=b();t(0,"button",58),u("click",function(){g(e);let o=d();return h(o.obtenerProximoNumeroFactura(o.comprobante==="Fiscal"?"B":"A"))}),v(),t(1,"svg",46),x(2,"path",59),i()()}if(n&2){let e=d();m("title",e.comprobante==="Fiscal"?"Proximo numero de factura B":"Proximo numero de factura A")}}function _e(n,s){if(n&1&&(t(0,"div",60),c(1),i()),n&2){let e=d();l(),_(" ",e.proximoNumeroFactura&&e.proximoNumeroFactura," ")}}function ve(n,s){if(n&1){let e=b();t(0,"button",61),u("click",function(){g(e);let o=d();return h(o.cambiarImprimirTicket())}),v(),t(1,"svg",62),x(2,"path",63),i(),C(),t(3,"p",64),c(4," Imprimir ticket "),i()()}}function fe(n,s){if(n&1){let e=b();t(0,"button",61),u("click",function(){g(e);let o=d();return h(o.cambiarImprimirTicket())}),v(),t(1,"svg",65),x(2,"path",66),i(),C(),t(3,"p",64),c(4," No imprimir ticket "),i()()}}function xe(n,s){if(n&1&&(t(0,"option",74),c(1),i()),n&2){let e=s.$implicit;m("value",e.descripcion),l(),_(" ",e.descripcion," ")}}function be(n,s){if(n&1){let e=b();t(0,"div",70)(1,"select",71),u("ngModelChange",function(o){g(e);let a=d(2);return h(a.tipoDocumento=o)}),S(2,xe,2,2,"option",32),i(),t(3,"input",72),u("keyup.enter",function(){g(e);let o=d(2);return h(o.buscarDatosContribuyente())})("ngModelChange",function(o){g(e);let a=d(2);return h(a.docContribuyente=o)}),i(),t(4,"button",73),u("click",function(){g(e);let o=d(2);return h(o.buscarDatosContribuyente())}),v(),t(5,"svg",46),x(6,"path",50),i()()()}if(n&2){let e=d(2);l(),m("ngModel",e.tipoDocumento),l(),m("ngForOf",e.tiposDocumentos),l(),m("ngModel",e.docContribuyente)}}function Ce(n,s){if(n&1&&(t(0,"div",67)(1,"p",68),c(2," Factura A "),i(),S(3,be,7,3,"div",69),i()),n&2){let e=d();l(3),m("ngIf",!e.contribuyenteSeleccionado)}}function Se(n,s){if(n&1){let e=b();t(0,"div",75)(1,"p")(2,"span",9),c(3," Razon social: "),i(),t(4,"span"),c(5),i()(),t(6,"p",76)(7,"span",9),c(8),i(),t(9,"span"),c(10),i()(),t(11,"p",76)(12,"span",9),c(13," Domicilio: "),i(),t(14,"span"),c(15),i()(),t(16,"div",77)(17,"button",78),u("click",function(){g(e);let o=d();return h(o.cancelarContribuyente())}),c(18," Cancelar "),i()()()}if(n&2){let e=d();l(5),_(" ",e.contribuyenteSeleccionado==null?null:e.contribuyenteSeleccionado.razonSocial,""),l(3),_(" ",e.contribuyenteSeleccionado==null?null:e.contribuyenteSeleccionado.tipoIdentificacion,": "),l(2),_(" ",e.contribuyenteSeleccionado==null?null:e.contribuyenteSeleccionado.identificacion,""),l(5),_(" ",e.contribuyenteSeleccionado==null?null:e.contribuyenteSeleccionado.domicilio,"")}}function Pe(n,s){if(n&1&&(t(0,"option",74),c(1),i()),n&2){let e=s.$implicit;m("value",e.valor),l(),_(" ",e.descripcion," ")}}function Ve(n,s){if(n&1){let e=b();t(0,"div",79)(1,"input",80),u("ngModelChange",function(o){g(e);let a=d();return h(a.pedidosYaComprobante=o)}),i()()}if(n&2){let e=d();l(),m("ngModel",e.pedidosYaComprobante)}}function ye(n,s){if(n&1){let e=b();t(0,"button",81),u("click",function(){g(e);let o=d();return h(o.cambiarMultiplesFormasPago())}),c(1," Multiples formas de pago "),i()}}function we(n,s){if(n&1){let e=b();t(0,"div",82)(1,"input",83),u("keyup.enter",function(){g(e);let o=d();return h(o.agregarFormaPago())})("ngModelChange",function(o){g(e);let a=d();return h(a.valorFormaPago=o)}),i(),t(2,"button",84),u("click",function(){g(e);let o=d();return h(o.agregarFormaPago())}),v(),t(3,"svg",46),x(4,"path",85),i()(),C(),t(5,"button",86),u("click",function(){g(e);let o=d();return h(o.cambiarMultiplesFormasPago())}),v(),t(6,"svg",46),x(7,"path",66),i()()()}if(n&2){let e=d();l(),m("ngModel",e.valorFormaPago)}}var Te=(n,s)=>s.descripcion;function ke(n,s){if(n&1){let e=b();t(0,"div",89)(1,"p",90),c(2),i(),t(3,"p",90),c(4),P(5,"moneda"),i(),t(6,"button",91),u("click",function(){let a=g(e).$implicit,p=d(2);return h(p.eliminarFormaPago(a.descripcion))}),v(),t(7,"svg",46),x(8,"path",92),i()()()}if(n&2){let e=s.$implicit;l(2),_(" ",e.descripcion," "),l(2),_(" $",V(5,2,e.valor)," ")}}function Ee(n,s){n&1&&(t(0,"div",93),c(1," Agregar al menos una forma de pago "),i())}function Fe(n,s){if(n&1&&(t(0,"div",87)(1,"h1",88),c(2," Formas de pago agregadas "),i(),t(3,"div"),I(4,ke,9,4,"div",94,Te,!1,Ee,2,0),i()()),n&2){let e=d();l(4),M(e.formasPago)}}function Ie(n,s){if(n&1){let e=b();v(),C(),t(0,"div",95)(1,"div",82)(2,"input",96),u("keyup.enter",function(){g(e);let o=d();return h(o.productoPorCodigo())})("ngModelChange",function(o){g(e);let a=d();return h(a.codigo=o)}),i(),t(3,"button",97),u("click",function(){g(e);let o=d();return h(o.productoPorCodigo())}),c(4," Agregar "),i()()()}if(n&2){let e=d();l(2),m("ngModel",e.codigo)}}function Me(n,s){if(n&1){let e=b();t(0,"div",103),u("click",function(){let a=g(e).$implicit,p=d(3);return h(p.seleccionarProducto(a))}),t(1,"p"),c(2),i(),t(3,"p",104),c(4),P(5,"moneda"),i()()}if(n&2){let e=s.$implicit;l(2),_(" ",e.descripcion," "),l(2),E(" $",V(5,3,e.precioVenta)," x ",e.unidadMedida.descripcion," ")}}function Ne(n,s){n&1&&(t(0,"div",105),c(1," No se encontraron productos "),i())}function Be(n,s){if(n&1){let e=b();v(),C(),t(0,"div",100)(1,"input",101),u("ngModelChange",function(o){g(e);let a=d(2);return h(a.filtro.productos=o)}),i(),t(2,"div",102),I(3,Me,6,5,"div",106,ge,!1,Ne,2,0),P(6,"filtroProductos"),i()()}if(n&2){let e=d(2);l(),m("ngModel",e.filtro.productos),l(2),M(z(6,2,e.productos,e.filtro.productos,""))}}function Ae(n,s){if(n&1){let e=b();v(),C(),t(0,"div",12)(1,"div",107)(2,"div",82)(3,"div",108),x(4,"img",109),i(),t(5,"div",110)(6,"p",111),c(7),i(),t(8,"p",112),c(9),P(10,"moneda"),i()()(),t(11,"div",113)(12,"input",114),u("keyup.enter",function(){g(e);let o=d(2);return h(o.agregarProductoCarrito(o.productoSeleccionado,o.cantidad))})("ngModelChange",function(o){g(e);let a=d(2);return h(a.cantidad=o)}),i(),t(13,"button",115),u("click",function(){g(e);let o=d(2);return h(o.agregarProductoCarrito(o.productoSeleccionado,o.cantidad))}),v(),t(14,"svg",46),x(15,"path",85),i()(),C(),t(16,"button",116),u("click",function(){g(e);let o=d(2);return h(o.cancelarProductoSeleccionado())}),v(),t(17,"svg",46),x(18,"path",66),i()()()()()}if(n&2){let e=d(2);l(7),_(" ",e.productoSeleccionado==null?null:e.productoSeleccionado.descripcion," "),l(2),E(" $",V(10,4,e.productoSeleccionado==null?null:e.productoSeleccionado.precioVenta)," x ",e.productoSeleccionado==null?null:e.productoSeleccionado.unidadMedida.descripcion," "),l(3),m("ngModel",e.cantidad)}}function Le(n,s){if(n&1&&(v(),S(0,Be,7,6,"div",98)(1,Ae,19,6,"div",99)),n&2){let e=d();m("ngIf",!e.productoSeleccionado),l(),m("ngIf",e.productoSeleccionado)}}function je(n,s){if(n&1&&(v(),C(),t(0,"div",117)(1,"div",108),x(2,"img",118),i(),t(3,"div",119)(4,"p",120),c(5),i(),t(6,"p",121)(7,"span",9),c(8," Precio unitario: "),i(),c(9),P(10,"moneda"),i(),t(11,"p",121)(12,"span",9),c(13," Cantidad: "),i(),c(14),i(),t(15,"p",122),c(16),P(17,"moneda"),i()()()),n&2){let e=d();l(5),_(" ",e.ultimoProductoCargado==null?null:e.ultimoProductoCargado.descripcion," "),l(4),_(" $",V(10,5,e.ultimoProductoCargado==null?null:e.ultimoProductoCargado.precioUnitario)," "),l(5),E(" ",e.ultimoProductoCargado.cantidad," (",e.ultimoProductoCargado==null?null:e.ultimoProductoCargado.unidadMedida,") "),l(2),_(" $",V(17,7,e.ultimoProductoCargado.precioTotal)," ")}}function ze(n,s){if(n&1){let e=b();t(0,"div")(1,"button",123),u("click",function(){g(e);let o=d();return h(o.abrirCompletarVenta())}),v(),t(2,"svg",46),x(3,"path",63),i()(),C(),t(4,"button",124),u("click",function(){g(e);let o=d();return h(o.cancelarVenta())}),v(),t(5,"svg",46),x(6,"path",66),i()()()}}function De(n,s){if(n&1&&(t(0,"div",125),c(1),P(2,"moneda"),i()),n&2){let e=d();l(),_(" $",V(2,1,e.precioTotalVenta)," ")}}function Ge(n,s){if(n&1){let e=b();t(0,"div",126),u("click",function(){let a=g(e).$implicit,p=d();return h(p.eliminarProductoCarrito(a.producto.id))}),t(1,"div",127),x(2,"img",118),i(),t(3,"div",119)(4,"p",120),c(5),i(),t(6,"p",121)(7,"span",9),c(8," Precio unitario: "),i(),c(9),P(10,"moneda"),i(),t(11,"p",121)(12,"span",9),c(13," Cantidad: "),i(),c(14),i(),t(15,"p",128),c(16),P(17,"moneda"),i()()()}if(n&2){let e=s.$implicit;l(5),_(" ",e==null?null:e.producto.descripcion," "),l(4),_(" $",V(10,5,e==null?null:e.producto.precioVenta)," "),l(5),E(" ",e.cantidad," (",e==null?null:e.producto.unidadMedida.descripcion,") "),l(2),_(" $",V(17,7,e.precioTotal)," ")}}function $e(n,s){n&1&&(t(0,"div",129),v(),t(1,"svg",130),x(2,"path",131),i(),C(),t(3,"p",132),c(4," La venta no tiene productos cargados "),i()())}var ue=(n,s)=>({"bg-pink-50 border-4 border-secondaryColor":n,"bg-white":s}),Oe=Y.base_url,_t=(()=>{let s=class s{constructor(r,o,a,p,f){this.authService=r,this.dataService=o,this.productosService=a,this.alertService=p,this.ventasService=f,this.fechaActual=new Date,this.estadoVenta="Codigo",this.showModalCompletar=!1,this.imprimirTicket=!0,this.codigo="",this.ultimoProductoCargado=null,this.productoSeleccionado=null,this.productos=[],this.carritoProductos=[],this.cantidad=null,this.precio=null,this.comprobante="Normal",this.totalBalanza=0,this.totalNoBalanza=0,this.pedidosYaComprobante="",this.adicionalCredito=0,this.valorFormaPago=null,this.formaPago="Efectivo",this.porcentajePorCredito=N.porcentajePorCredito,this.precioTotalVenta=0,this.precioTotalLimpio=0,this.vuelto=null,this.pagaCon=null,this.totalPagado=0,this.faltaPagar=0,this.multiplesFormasPago=!1,this.formasPago=[],this.filtro={productos:""},this.tiposDocumentos=pe,this.tipoDocumento="CUIT",this.contribuyenteSeleccionado=null,this.docContribuyente="",this.proximoNumeroFactura=null,this.formasPagoArray=F}ngOnInit(){this.dataService.ubicacionActual="Dashboard - Generando venta",te.from(".gsap-contenido",{y:100,opacity:0,duration:.2}),this.recuperarDeLocalStorage()}productoPorCodigo(){if(this.codigo?.trim()===""){this.alertService.info("Debe colocar un codigo de producto");return}this.alertService.loading(),this.productosService.getProductoPorCodigo(this.codigo).subscribe({next:({producto:r,cantidad:o,precio:a})=>{this.codigo="",this.agregarProductoCarrito(r,o,a),this.alertService.close()},error:({error:r})=>{this.codigo="",this.alertService.errorApi(r.message)}})}seleccionarProducto(r){this.filtro.productos="",this.productoSeleccionado=r,this.almacenarEnLocalStorage()}agregarProductoCarrito(r,o,a=0){let p=0;a===0?p=r.precioVenta*o:p=a,this.ultimoProductoCargado={descripcion:r.descripcion,precioUnitario:r.precioVenta,precioTotal:p,cantidad:o,unidadMedida:r.unidadMedida.descripcion};let f=this.carritoProductos.find(k=>k.producto.id==r.id);if(f){f.cantidad+=o,f.precioTotal+=p,this.productoSeleccionado=null,this.cantidad=null,this.calcularPrecioFinal();return}else{let k={producto:r,cantidad:o,precioUnitario:r.precioVenta,precioTotal:p,creatorUserId:this.authService.usuario.userId};this.carritoProductos.unshift(k),this.productoSeleccionado=null,this.cantidad=null,this.calcularPrecioFinal()}}agregarFormaPago(){if(this.valorFormaPago<=0){this.alertService.info("Debe colocar un monto valido");return}if(this.formasPago.find(o=>o.descripcion==this.formaPago))return this.alertService.info("La forma de pago ya esta agregada");if(this.totalPagado+=this.valorFormaPago,this.totalPagado>this.precioTotalVenta){this.alertService.info("El total pagado no puede ser mayor al precio final"),this.totalPagado-=this.valorFormaPago;return}this.formasPago.unshift({valor:this.valorFormaPago,descripcion:this.formaPago,creatorUserId:this.authService.usuario.userId}),this.calcularPrecioFinal(),this.calcularFaltaPagar()}eliminarProductoCarrito(r){this.alertService.question({msg:"\xBFQuieres quitar el producto?",buttonText:"Quitar"}).then(({isConfirmed:o})=>{o&&(this.carritoProductos=this.carritoProductos.filter(a=>a.producto.id!=r),this.carritoProductos.length===0&&(this.ultimoProductoCargado=null),this.calcularPrecioFinal())})}eliminarFormaPago(r){this.formasPago=this.formasPago.filter(o=>o.descripcion!=r),this.totalPagado=0,this.formasPago.forEach(o=>{this.totalPagado+=o.valor}),this.calcularFaltaPagar()}cancelarVenta(){this.alertService.question({msg:"\xBFQuieres reiniciar la venta?",buttonText:"Reiniciar"}).then(({isConfirmed:r})=>{r&&this.reiniciarVenta()})}cancelarProductoSeleccionado(){this.productoSeleccionado=null,this.filtro.productos="",this.almacenarEnLocalStorage()}abrirCompletarVenta(){this.showModalCompletar=!0}cambiarEstadoVenta(r){this.estadoVenta=r,this.codigo="",this.filtro.productos="",this.productoSeleccionado=null,r!=="Codigo"&&(this.alertService.loading(),this.productosService.listarProductos({}).subscribe({next:({productos:o})=>{this.productos=o,this.alertService.close()},error:({error:o})=>this.alertService.errorApi(o.message)})),this.almacenarEnLocalStorage()}cambiarImprimirTicket(){this.imprimirTicket=!this.imprimirTicket,this.almacenarEnLocalStorage()}cambiarFormaPago(){this.multiplesFormasPago||this.calcularPrecioFinal()}cambiarMultiplesFormasPago(){this.formaPago="Efectivo",this.multiplesFormasPago=!this.multiplesFormasPago,this.multiplesFormasPago?this.formasPagoArray=se:this.formasPagoArray=F,this.valorFormaPago=this.precioTotalLimpio,this.precioTotalVenta=this.precioTotalLimpio,this.faltaPagar=this.precioTotalVenta,this.totalPagado=0,this.formasPago=[],this.almacenarEnLocalStorage()}calcularFaltaPagar(){this.faltaPagar=this.precioTotalVenta-this.totalPagado,this.faltaPagar=Math.round(this.faltaPagar*100)/100,this.valorFormaPago=this.faltaPagar,this.almacenarEnLocalStorage()}calcularVuelto(){this.vuelto=this.pagaCon-this.precioTotalVenta,this.vuelto<0&&(this.vuelto=null)}calcularPrecioFinal(){let r=0,o=0,a=0,p=0;this.adicionalCredito=0,this.carritoProductos.forEach(f=>{r+=f.producto.balanza?f.precioTotal:0,o+=f.producto.balanza?0:f.precioTotal,a+=f.precioTotal,p+=f.precioTotal}),this.precioTotalVenta=a,this.precioTotalLimpio=p,this.totalBalanza=r,this.totalNoBalanza=o,this.formaPago==="Credito"&&!this.multiplesFormasPago&&(this.adicionalCredito=this.precioTotalVenta*(this.porcentajePorCredito/100),this.precioTotalVenta+=this.adicionalCredito),this.precioTotalVenta=Math.round(this.precioTotalVenta*100)/100,this.precioTotalLimpio=Math.round(this.precioTotalLimpio*100)/100,this.totalBalanza=Math.round(this.totalBalanza*100)/100,this.totalNoBalanza=Math.round(this.totalNoBalanza*100)/100,this.adicionalCredito=Math.round(this.adicionalCredito*100)/100,this.almacenarEnLocalStorage()}completarVenta(){if((this.formaPago==="PedidosYa - Efectivo"||this.formaPago==="PedidosYa - Online")&&!this.multiplesFormasPago&&this.pedidosYaComprobante===""){this.alertService.info("Debe colocar el nro de comprobante");return}if(this.multiplesFormasPago&&this.precioTotalVenta-this.totalPagado>.1){this.alertService.info("El total pagado debe ser igual al precio final");return}if(this.comprobante==="FacturaA"&&!this.contribuyenteSeleccionado){this.alertService.info("Debe buscar un contribuyente");return}let r=(this.formaPago==="PedidosYa - Efectivo"||this.formaPago==="PedidosYa - Online")&&!this.multiplesFormasPago,o={comprobante:this.comprobante,precioTotal:this.precioTotalVenta,totalBalanza:this.totalBalanza,totalNoBalanza:this.totalNoBalanza,precioTotalLimpio:this.precioTotalLimpio,adicionalCredito:!this.multiplesFormasPago&&this.formaPago==="Credito"?this.adicionalCredito:0,creatorUserId:this.authService.usuario.userId},a=[];this.carritoProductos.map(y=>{a.push({productoId:y.producto.id,cantidad:y.cantidad,precioUnitario:y.precioUnitario,precioTotal:y.precioTotal,alicuota:y.producto.alicuota,creatorUserId:this.authService.usuario.userId})});let p=[];this.multiplesFormasPago?p=this.formasPago:p=[{valor:this.precioTotalVenta,descripcion:this.formaPago,nroComprobante:r?this.pedidosYaComprobante:"",creatorUserId:this.authService.usuario.userId}];let f={dataVenta:o,dataFormasPago:p,dataProductos:a,dataOtros:{imprimirTicket:this.imprimirTicket},sena:!1},k={dataVenta:o,dataFormasPago:p,dataProductos:a,dataFacturacion:{comprobante:this.comprobante,razonSocial:this.comprobante==="FacturaA"?this.contribuyenteSeleccionado?.razonSocial:"",tipoFactura:this.comprobante==="Normal"?"":this.comprobante==="FacturaA"?"A":"B",tipoDocContribuyente:this.comprobante==="Normal"?"":this.tipoDocumento,docContribuyente:this.docContribuyente,domicilio:this.comprobante==="FacturaA"?this.contribuyenteSeleccionado?.domicilio:"",tipoDomicilio:this.comprobante==="FacturaA"?this.contribuyenteSeleccionado?.tipoDomicilio:"",tipoPersona:this.comprobante==="FacturaA"?this.contribuyenteSeleccionado?.tipoPersona:""},dataOtros:{imprimirTicket:this.imprimirTicket},sena:!1};this.alertService.question({msg:"\xBFQuieres completar la venta?",buttonText:"Completar"}).then(({isConfirmed:y})=>{y&&(this.alertService.loading(),this.comprobante==="Normal"?this.ventasService.nuevaVenta(f).subscribe({next:({venta:w})=>{this.reiniciarVenta(),this.alertService.close(),this.imprimirTicket&&window.open(`${Oe}/ventas/generar/comprobante/${w.id}`,"_blank")},error:({error:w})=>this.alertService.errorApi(w.message)}):this.comprobante!=="Normal"&&this.ventasService.nuevaVentaFacturacion(k).subscribe({next:({venta:w})=>{this.reiniciarVenta(),this.alertService.close()},error:({error:w})=>this.alertService.errorApi(w.message)}))})}obtenerProximoNumeroFactura(r="B"){this.alertService.loading(),this.ventasService.proximoNumeroFactura(r).subscribe({next:({proximoNumeroFactura:o})=>{this.proximoNumeroFactura=o,this.alertService.close()},error:({error:o})=>this.alertService.errorApi(o.message)})}buscarDatosContribuyente(){if(this.docContribuyente.length!==11){this.alertService.info("El CUIT debe tener 11 digitos");return}this.alertService.loading(),this.ventasService.datosContribuyente(this.docContribuyente).subscribe({next:r=>{this.contribuyenteSeleccionado={razonSocial:r.contribuyente.datosGenerales.razonSocial,tipoIdentificacion:r.contribuyente.datosGenerales.tipoClave,identificacion:r.contribuyente.datosGenerales.idPersona,tipoPersona:r.contribuyente.datosGenerales.tipoPersona,domicilio:r.contribuyente.datosGenerales.domicilioFiscal.direccion,tipoDomicilio:r.contribuyente.datosGenerales.domicilioFiscal.tipoDomicilio},console.log(this.contribuyenteSeleccionado),this.alertService.close()},error:({error:r})=>this.alertService.errorApi(r.message)})}cancelarContribuyente(){this.docContribuyente="",this.contribuyenteSeleccionado=null}reiniciarVenta(){this.codigo="",this.precioTotalVenta=0,this.precioTotalLimpio=0,this.pedidosYaComprobante="",this.ultimoProductoCargado=null,this.comprobante="Normal",this.totalBalanza=0,this.totalNoBalanza=0,this.adicionalCredito=0,this.valorFormaPago=null,this.formaPago="Efectivo",this.porcentajePorCredito=N.porcentajePorCredito,this.vuelto=null,this.pagaCon=null,this.estadoVenta="Codigo",this.showModalCompletar=!1,this.productoSeleccionado=null,this.productos=[],this.carritoProductos=[],this.cantidad=null,this.precio=null,this.totalPagado=0,this.faltaPagar=0,this.multiplesFormasPago=!1,this.formasPago=[],this.formasPagoArray=F,this.filtro={productos:""},this.proximoNumeroFactura=null,this.almacenarEnLocalStorage()}cambioComprobante(){this.contribuyenteSeleccionado=null,this.docContribuyente="",this.proximoNumeroFactura="",this.almacenarEnLocalStorage()}almacenarEnLocalStorage(){this.carritoProductos&&localStorage.setItem("venta-carritoProductos",JSON.stringify(this.carritoProductos)),this.comprobante&&localStorage.setItem("venta-comprobante",this.comprobante),localStorage.setItem("venta-totalBalanza",this.totalBalanza.toString()),localStorage.setItem("venta-totalNoBalanza",this.totalNoBalanza.toString()),localStorage.setItem("venta-adicionalCredito",this.adicionalCredito.toString()),this.valorFormaPago&&localStorage.setItem("venta-valorFormaPago",this.valorFormaPago.toString()),this.formaPago&&localStorage.setItem("venta-formaPago",this.formaPago),this.porcentajePorCredito&&localStorage.setItem("venta-porcentajePorCredito",this.porcentajePorCredito.toString()),localStorage.setItem("venta-precioTotalVenta",this.precioTotalVenta.toString()),localStorage.setItem("venta-precioTotalLimpio",this.precioTotalLimpio.toString()),localStorage.setItem("venta-imprimirTicket",this.imprimirTicket.toString()),this.productos&&localStorage.setItem("venta-productos",JSON.stringify(this.productos)),localStorage.setItem("venta-totalPagado",this.totalPagado.toString()),localStorage.setItem("venta-faltaPagar",this.faltaPagar.toString()),localStorage.setItem("venta-multiplesFormasPago",this.multiplesFormasPago.toString()),this.formasPago&&localStorage.setItem("venta-formasPago",JSON.stringify(this.formasPago)),this.formasPagoArray&&localStorage.setItem("venta-formasPagoArray",JSON.stringify(this.formasPagoArray))}recuperarDeLocalStorage(){this.carritoProductos=JSON.parse(localStorage.getItem("venta-carritoProductos"))||[],this.comprobante=localStorage.getItem("venta-comprobante")||"Normal",this.totalBalanza=parseFloat(localStorage.getItem("venta-totalBalanza"))||0,this.totalNoBalanza=parseFloat(localStorage.getItem("venta-totalNoBalanza"))||0,this.adicionalCredito=parseFloat(localStorage.getItem("venta-adicionalCredito"))||0,this.valorFormaPago=parseFloat(localStorage.getItem("venta-valorFormaPago"))||null,this.formaPago=localStorage.getItem("venta-formaPago")||"Efectivo",this.porcentajePorCredito=parseFloat(localStorage.getItem("venta-porcentajePorCredito"))||N.porcentajePorCredito,this.precioTotalVenta=parseFloat(localStorage.getItem("venta-precioTotalVenta"))||0,this.precioTotalLimpio=parseFloat(localStorage.getItem("venta-precioTotalLimpio"))||0,this.imprimirTicket=localStorage.getItem("venta-imprimirTicket")==="true",this.productos=JSON.parse(localStorage.getItem("venta-productos"))||[],this.totalPagado=parseFloat(localStorage.getItem("venta-totalPagado"))||0,this.faltaPagar=parseFloat(localStorage.getItem("venta-faltaPagar"))||0,this.multiplesFormasPago=localStorage.getItem("venta-multiplesFormasPago")==="true",this.formasPago=JSON.parse(localStorage.getItem("venta-formasPago"))||[],this.formasPagoArray=JSON.parse(localStorage.getItem("venta-formasPagoArray"))||F,this.valorFormaPago=parseFloat(localStorage.getItem("venta-valorFormaPago"))||null}};s.\u0275fac=function(o){return new(o||s)(T(U),T(oe),T(de),T(ie),T(me))},s.\u0275cmp=L({type:s,selectors:[["app-ventas"]],standalone:!0,features:[j],decls:88,vars:39,consts:[[3,"showModal"],[1,"flex","items-center","justify-between","bg-gray-800","rounded-t","p-2"],[1,"text-white","px-2","py-1","rounded-t","text-lg"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"cursor-pointer","feather","feather-x","text-white","mr-2",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"text-sm"],[1,"text-xs","md:text-sm","flex","bg-gray-100","items-center","border-b","border-gray-400","justify-between","px-3","py-3"],[1,"border","p-2","border-gray-400","bg-white"],[1,"font-semibold"],[1,"bg-purple-100","p-2","border","border-secondaryColor"],[1,"max-h-96","overflow-y-auto"],[1,"p-2"],[1,"flex","items-center","w-full"],[1,"input-generico","w-full","mt-2",3,"ngModel","change","ngModelChange"],["value","Normal"],["value","Fiscal"],["value","FacturaA"],["class","p-2 border outline-none hover:text-secondaryColor border-gray-400 rounded mt-2 ml-2",3,"title","click",4,"ngIf"],["class","w-full font-semibold text-center ml-2 p-2 bg-gray-50 border mt-2 border-gray-400",4,"ngIf"],["class","px-2 py-1 shadow bg-gray-50 mt-2 flex items-center border border-gray-400 rounded",3,"click",4,"ngIf"],["class","mt-2 text-sm pb-3 border-gray-300 px-2",4,"ngIf"],["class","text-sm px-2 pb-2 border-gray-300",4,"ngIf"],[1,"px-2","pt-2","border-t","border-gray-300","text-sm"],[1,"flex","items-center","mt-2"],["placeholder","Paga con...","type","text",1,"input-generico","w-1/2",3,"ngModel","keyup","ngModelChange"],[1,"w-1/2","bg-gray-100","border","border-gray-400","p-2","ml-2","text-center"],[1,"px-2","mt-2","text-sm"],[1,"flex","items-center","justify-between"],[1,"font-semibold","w-1/2"],[1,"md:flex","md:items-center","mt-2"],[1,"input-generico","w-full","md:w-1/2",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","md:ml-2 mt-2 md:mt-0 w-full md:w-1/2",4,"ngIf"],["class","md:w-1/2 w-full p-2 border border-gray-400 rounded md:ml-2 mt-2 md:mt-0 hover:text-secondaryColor",3,"click",4,"ngIf"],["class","flex items-center",4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"p-2","mt-2"],[1,"boton-crear","w-full",3,"click"],[1,"p-2","w-11/12","mx-auto","gsap-contenido"],[1,"w-full","md:justify-center","md:flex","mx-auto","mt-2"],[1,"w-full","md:w-1/2"],[1,"border","border-gray-400"],[1,"p-2","flex","items-center","justify-between","bg-gray-800"],[1,"text-md","md:text-lg","text-white"],["title","Venta por codigo",1,"p-2","border","hover:text-secondaryColor","border-gray-400",3,"ngClass","click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"],["stroke-linecap","round","stroke-linejoin","round","d","M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"],["title","Buscador de productos",1,"p-2","ml-2","border","hover:text-secondaryColor","border-gray-400",3,"ngClass","click"],["stroke-linecap","round","stroke-linejoin","round","d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"],["class","p-2 text-sm"],["class","border mt-2 border-gray-400 p-2 flex items-center"],[1,"w-full","md:w-1/2","mt-2","md:mt-0","md:ml-2","border","h-max","border-gray-400"],[1,"bg-gray-800","p-2","flex","items-center","justify-between"],[1,"text-white"],[4,"ngIf"],["class","px-2 py-4 text-center text-xl md:text-3xl border border-secondaryColor bg-purple-100 mb-4",4,"ngIf"],[1,"p-2","border","outline-none","hover:text-secondaryColor","border-gray-400","rounded","mt-2","ml-2",3,"title","click"],["stroke-linecap","round","stroke-linejoin","round","d","M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"],[1,"w-full","font-semibold","text-center","ml-2","p-2","bg-gray-50","border","mt-2","border-gray-400"],[1,"px-2","py-1","shadow","bg-gray-50","mt-2","flex","items-center","border","border-gray-400","rounded",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-4","h-4","text-green-700","font-semibold"],["stroke-linecap","round","stroke-linejoin","round","d","m4.5 12.75 6 6 9-13.5"],[1,"text-xs"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-4","h-4","text-red-700","font-semibold"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18 18 6M6 6l12 12"],[1,"mt-2","text-sm","pb-3","border-gray-300","px-2"],[1,"font-semibold","border","bg-gray-100","border-gray-400","p-1"],["class","flex items-center mt-2 py-2",4,"ngIf"],[1,"flex","items-center","mt-2","py-2"],[1,"input-generico",3,"ngModel","ngModelChange"],["placeholder","Ej. 24340603989","type","text",1,"input-generico","ml-2",3,"ngModel","keyup.enter","ngModelChange"],["title","Buscar cliente",1,"p-2","border","ml-2","border-gray-400","rounded","hover:text-secondaryColor",3,"click"],[3,"value"],[1,"text-sm","px-2","pb-2","border-gray-300"],[1,"mt-2"],[1,"flex","items-center","mt-2","mb-2"],[1,"boton-eliminar","px-2",3,"click"],[1,"md:ml-2","mt-2","md:mt-0","w-full","md:w-1/2"],["placeholder","Nro comprobante pedidosYa","type","text",1,"input-generico","w-full",3,"ngModel","ngModelChange"],[1,"md:w-1/2","w-full","p-2","border","border-gray-400","rounded","md:ml-2","mt-2","md:mt-0","hover:text-secondaryColor",3,"click"],[1,"flex","items-center"],["placeholder","Ej. 1000","type","number","min","0",1,"input-generico","w-full","mt-2","md:mt-0","md:ml-2",3,"ngModel","keyup.enter","ngModelChange"],["title","Agregar forma de pago",1,"boton-crear","ml-2","mt-2","md:mt-0",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4.5v15m7.5-7.5h-15"],["title","Regresar a forma unica",1,"boton-eliminar","ml-2","mt-2","md:mt-0",3,"click"],[1,"mt-3"],[1,"bg-gray-100","border","border-gray-400","p-2"],[1,"flex","items-center","p-2","justify-between","border-b","border-gray-400"],[1,"w-1/3"],["title","Quitar forma de pago",1,"boton-eliminar",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"],[1,"p-2","bg-gray-50","italic","text-xs","border","border-t-0","border-gray-400","text-center","text-gray-600"],["class","flex items-center p-2 justify-between border-b border-gray-400"],[1,"p-2","text-sm"],["type","text","placeholder","Codigo de producto",1,"w-full","input-generico",3,"ngModel","keyup.enter","ngModelChange"],["title","Agregar producto",1,"bg-secondaryColor","hover:opacity-90","text-sm","w-max","text-white","rounded","p-2","ml-2",3,"click"],["class","p-2 text-sm border-t",4,"ngIf"],["class","p-2",4,"ngIf"],[1,"p-2","text-sm","border-t"],["placeholder","Buscar producto","type","text",1,"input-generico","w-full","mb-2",3,"ngModel","ngModelChange"],[1,"border","max-h-96","border-b-0","overflow-y-auto","border-gray-400"],[1,"border-b","border-gray-400","hover:bg-purple-50","text-xs","md:text-md","cursor-pointer","p-2",3,"click"],[1,"text-xs","text-gray-500","mt-1"],[1,"p-2","bg-gray-100","border-b","text-center","italic","text-gray-600","border-gray-400"],["class","border-b border-gray-400 hover:bg-purple-50 text-xs md:text-md cursor-pointer p-2"],[1,"border","md:flex","md:items-center","md:justify-between","border-gray-400","p-2"],[1,"bg-green-50","border","border-green-700","p-2","rounded","text-green-700"],["src","assets/svg/producto.svg","alt","producto.svg",1,"w-14"],[1,"ml-2"],[1,"text-xs","md:text-md"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","mt-2","text-sm"],["min","0","placeholder","Cantidad","type","number",1,"input-generico","mt-2","md:mt-0","w-full","md:w-28",3,"ngModel","keyup.enter","ngModelChange"],["title","Agregar producto",1,"boton-crear","ml-2","mt-1","md:mt-0",3,"click"],["title","Cancelar seleccion",1,"boton-eliminar","ml-2","mt-1","md:mt-0",3,"click"],[1,"border","mt-2","border-gray-400","p-2","flex","items-center"],["src","assets/svg/producto.svg","alt","producto.svg",1,"w-20"],[1,"ml-4"],[1,"font-semibold","text-sm","md:text-md"],[1,"text-xs","mt-1"],[1,"text-green-700","text-sm","md:text-lg","font-semibold","mt-2"],["title","Completar venta",1,"boton-crear","ml-2",3,"click"],["title","Reiniciar venta",1,"boton-eliminar","ml-2",3,"click"],[1,"px-2","py-4","text-center","text-xl","md:text-3xl","border","border-secondaryColor","bg-purple-100","mb-4"],[1,"p-2","border","border-gray-400","mb-2","flex","items-center","hover:border-secondaryColor","cursor-pointer",3,"click"],[1,"bg-purple-50","border","border-secondaryColor","p-2","rounded","text-secondaryColor"],[1,"text-secondaryColor","font-semibold","mt-2"],[1,"border","p-2","border-gray-400","bg-gray-100","text-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-14","h-14","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","d","m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"],[1,"text-gray-600","text-sm","mt-1","italic"],["class","p-2 border border-gray-400 mb-2 flex items-center hover:border-secondaryColor cursor-pointer"]],template:function(o,a){o&1&&(t(0,"app-modal",0)(1,"div",1)(2,"h1",2),c(3," Completando venta "),i(),v(),t(4,"svg",3),u("click",function(){return a.showModalCompletar=!1}),x(5,"line",4)(6,"line",5),i()(),C(),t(7,"div",6)(8,"div",7)(9,"p",8)(10,"span",9),c(11," Fecha: "),i(),c(12),P(13,"fecha"),i(),t(14,"p",10)(15,"span",9),c(16," Precio total: "),i(),c(17),P(18,"moneda"),i()(),t(19,"div",11)(20,"div",12)(21,"p",9),c(22," Tipo de venta "),i(),t(23,"div",13)(24,"select",14),u("change",function(){return a.cambioComprobante()})("ngModelChange",function(f){return a.comprobante=f}),t(25,"option",15),c(26," Normal "),i(),t(27,"option",16),c(28," Guia de despacho "),i(),t(29,"option",17),c(30," Factura A "),i()(),t(31,"div",13),S(32,he,3,1,"button",18)(33,_e,2,1,"div",19),i()(),S(34,ve,5,0,"button",20)(35,fe,5,0,"button",20),i(),S(36,Ce,4,1,"div",21)(37,Se,19,4,"div",22),t(38,"div",23)(39,"p",9),c(40," Calculador de vuelto "),i(),t(41,"div",24)(42,"input",25),u("keyup",function(){return a.calcularVuelto()})("ngModelChange",function(f){return a.pagaCon=f}),i(),t(43,"div",26),c(44),P(45,"moneda"),i()()(),t(46,"div",27)(47,"div",28)(48,"p",29),c(49),i()(),t(50,"div",30)(51,"select",31),u("change",function(){return a.cambiarFormaPago()})("ngModelChange",function(f){return a.formaPago=f}),S(52,Pe,2,2,"option",32),i(),S(53,Ve,2,1,"div",33)(54,ye,2,0,"button",34)(55,we,8,1,"div",35),i(),S(56,Fe,7,1,"div",36),i()(),t(57,"div",37)(58,"button",38),u("click",function(){return a.completarVenta()}),c(59," Completar venta "),i()()()(),t(60,"div",39)(61,"div",40)(62,"div",41)(63,"div",42)(64,"div",43)(65,"h1",44),c(66),i(),t(67,"div")(68,"button",45),u("click",function(){return a.cambiarEstadoVenta("Codigo")}),v(),t(69,"svg",46),x(70,"path",47)(71,"path",48),i()(),C(),t(72,"button",49),u("click",function(){return a.cambiarEstadoVenta("Cantidad")}),v(),t(73,"svg",46),x(74,"path",50),i()()()(),S(75,Ie,5,1,"div",51)(76,Le,2,2),i(),S(77,je,18,9,"div",52),i(),C(),t(78,"div",53)(79,"div",54)(80,"h1",55),c(81," Productos en carrito "),i(),S(82,ze,7,0,"div",56),i(),t(83,"div",12),S(84,De,3,3,"div",57),I(85,Ge,18,9,"div",133,ge,!1,$e,5,0),i()()()()),o&2&&(m("showModal",a.showModalCompletar),l(12),_(" ",V(13,27,a.fechaActual)," "),l(5),_(" $",V(18,29,a.precioTotalVenta)," "),l(7),m("ngModel",a.comprobante),l(8),m("ngIf",a.comprobante!=="Normal"),l(),m("ngIf",a.proximoNumeroFactura&&a.comprobante!=="Normal"),l(),m("ngIf",a.imprimirTicket),l(),m("ngIf",!a.imprimirTicket),l(),m("ngIf",a.comprobante==="FacturaA"),l(),m("ngIf",a.contribuyenteSeleccionado),l(5),m("ngModel",a.pagaCon),l(2),_(" ",a.vuelto?"$"+V(45,31,a.vuelto):"Monto a devolver"," "),l(5),_(" ",a.multiplesFormasPago?"Multiples formas de pago":"Forma de pago"," "),l(2),m("ngModel",a.formaPago),l(),m("ngForOf",a.formasPagoArray),l(),m("ngIf",a.formaPago==="PedidosYa - Efectivo"||a.formaPago==="PedidosYa - Online"),l(),m("ngIf",!a.multiplesFormasPago&&a.formaPago!=="PedidosYa - Efectivo"&&a.formaPago!=="PedidosYa - Online"),l(),m("ngIf",a.multiplesFormasPago),l(),m("ngIf",a.multiplesFormasPago),l(10),_(" ",a.estadoVenta==="Codigo"?"Producto por codigo":a.estadoVenta==="Precio"?"Venta por precio":a.estadoVenta==="Cantidad"?"Buscador de productos":""," "),l(2),m("ngClass",A(33,ue,a.estadoVenta==="Codigo",a.estadoVenta!=="Codigo")),l(4),m("ngClass",A(36,ue,a.estadoVenta==="Cantidad",a.estadoVenta!=="Cantidad")),l(3),B(75,a.estadoVenta==="Codigo"?75:76),l(2),B(77,a.ultimoProductoCargado&&a.estadoVenta==="Codigo"?77:-1),l(5),m("ngIf",a.carritoProductos.length>0),l(2),m("ngIf",a.carritoProductos.length>0),l(),M(a.carritoProductos))},dependencies:[O,D,G,$,ee,K,W,Z,Q,q,J,X,R,ae,ne,re,H,le,ce],encapsulation:2});let n=s;return n})();export{_t as default};
