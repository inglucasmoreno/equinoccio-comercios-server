import{h as f,p as g,u as d}from"./chunk-BJBUZF5B.js";import{C as p,R as h,V as m,_ as c,o as u,s as n}from"./chunk-GQGQXF3A.js";var s=class{constructor(o,k,e,t,r,l){this.userId=o,this.usuario=k,this.nombre=e,this.apellido=t,this.role=r,this.permisos=l}};var a=d.base_url,E=(()=>{let o=class o{constructor(e,t){this.http=e,this.router=t}login(e){return this.http.post(`${a}/auth/login`,e).pipe(h(({token:t})=>{let r="bearer "+t;localStorage.setItem("token",r)}))}logout(){localStorage.removeItem("token"),this.router.navigateByUrl("login")}validarToken(){let e=localStorage.getItem("token");return this.http.get(`${a}/profile`,{headers:{Authorization:e}}).pipe(n(t=>{let{userId:r,usuario:l,apellido:I,nombre:b,role:v,permisos:S}=t.usuario;return this.usuario=new s(r,l,b,I,v,S),localStorage.setItem("token",t.token),!0}),p(t=>u(!1)))}validarAdmin(){let e=localStorage.getItem("token");return this.http.get(`${a}/profile`,{headers:{Authorization:e}}).pipe(n(t=>t.usuario.role==="ADMIN_ROLE"))}proteccionLogin(){let e=localStorage.getItem("token");return this.http.get(`${a}/auth`,{headers:{"x-token":e}}).pipe(n(()=>!1),p(t=>u(!0)))}};o.\u0275fac=function(t){return new(t||o)(c(f),c(g))},o.\u0275prov=m({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();export{E as a};
