import{a as D}from"./chunk-22XSY4EJ.js";import{a as P,c as V,e as U,o as R}from"./chunk-B2HCO65P.js";import{a as N}from"./chunk-BPTFILPP.js";import{b as q}from"./chunk-5N72VQB2.js";import{a as O}from"./chunk-VSPTT5AX.js";import{c as I,e as j,g as A,k as L,v as B}from"./chunk-BJBUZF5B.js";import{$a as c,Bb as T,Db as x,Ka as z,Ra as u,Sa as d,ba as F,cb as _,e as w,ga as h,gb as t,ha as S,hb as r,ia as G,ib as b,ja as k,lb as C,pb as p,qb as v,ub as l}from"./chunk-GQGQXF3A.js";function H(s,m){if(s&1){let f=C();t(0,"button",15),p("click",function(){h(f);let i=v();return S(i.eliminarImagen())}),G(),t(1,"svg",16),b(2,"path",17),r(),k(),t(3,"span",18),l(4," Eliminar seleccion "),r()()}}function J(s,m){if(s&1){let f=C();t(0,"button",19),p("click",function(){h(f);let i=v();return S(i.actualizarConfiguraciones())}),l(1," Actualizar sucursal "),r()}}var K=s=>({hidden:s}),se=(()=>{let m=class m{constructor(n,i,e,o,a){this.authService=n,this.dataService=i,this.alertService=e,this.configGeneralesService=o,this.sanitizer=a,this.permiso_escritura=!1,this.configGeneral={},this.configGeneralForm={nombreEmpresa:"",nombreSucursal:"",domicilioSucursal:"",telefonoSucursal:""},this.extraerBase64=y=>w(this,null,function*(){return new Promise((E,Q)=>{try{let M=window.URL.createObjectURL(y),W=this.sanitizer.bypassSecurityTrustUrl(M),g=new FileReader;g.readAsDataURL(y),g.onload=()=>{E({base:g.result})},g.onerror=X=>{E({base:null})}}catch{return null}})})}ngOnInit(){N.from(".gsap-contenido",{y:100,opacity:0,duration:.2}),this.dataService.ubicacionActual="Dashboard - Configuraci\xF3n de sucursal",this.calcularPermiso(),this.alertService.loading(),this.configGeneralesService.listarConfigGenerales({}).subscribe({next:({configGeneral:n})=>{this.configGeneral=n[0],this.configGeneralForm.nombreEmpresa=n[0].nombreEmpresa,this.configGeneralForm.nombreSucursal=n[0].nombreSucursal,this.configGeneralForm.domicilioSucursal=n[0].domicilioSucursal,this.configGeneralForm.telefonoSucursal=n[0].telefonoSucursal,this.alertService.close()},error:({error:n})=>this.alertService.errorApi(n.message)})}calcularPermiso(){this.authService.usuario.permisos.includes("SUCURSAL_ALL")||this.authService.usuario.role==="ADMIN_ROLE"?this.permiso_escritura=!0:this.permiso_escritura=!1}actualizarConfiguraciones(){if(this.configGeneralForm.nombreEmpresa===""){this.alertService.info("El campo de empresa no puede estar vac\xEDo");return}if(this.configGeneralForm.nombreSucursal===""){this.alertService.info("El campo de sucursal no puede estar vac\xEDo");return}this.alertService.loading();let n={nombreEmpresa:this.configGeneralForm.nombreEmpresa,nombreSucursal:this.configGeneralForm.nombreSucursal,domicilioSucursal:this.configGeneralForm.domicilioSucursal,telefonoSucursal:this.configGeneralForm.telefonoSucursal};this.configGeneralesService.actualizarConfigGeneral(this.configGeneral.id,n).subscribe({next:({configGeneral:i})=>{if(this.configGeneral=i,this.configGeneralForm.nombreEmpresa=i.nombreEmpresa,this.configGeneralForm.nombreSucursal=i.nombreSucursal,this.configGeneralForm.domicilioSucursal=i.domicilioSucursal,this.configGeneralForm.telefonoSucursal=i.telefonoSucursal,this.imagenParaSubir){this.alertService.loading();let e=new FormData;e.append("file",this.imagenParaSubir),this.configGeneralesService.actualizarLogoEmpresa(e).subscribe({next:()=>{this.file="",this.alertService.success("Configuraciones actualizadas correctamente")},error:({error:o})=>this.alertService.errorApi(o.message)})}else this.alertService.success("Configuraciones actualizadas correctamente")},error:({error:i})=>this.alertService.errorApi(i.message)})}capturarImagen(n){if(n.target.files[0]){this.imagenParaSubir=n.target.files[0];let i=this.imagenParaSubir.type.split("/")[1];if(i!=="png"&&i!=="jpg"&&i!=="jpeg"&&i!=="gif")return this.previsualizacion="",this.file="",this.alertService.errorApi("El archivo debe ser una imagen");this.extraerBase64(this.imagenParaSubir).then(o=>{this.previsualizacion=o.base})}}eliminarImagen(){this.file="",this.previsualizacion="",this.imagenParaSubir=null}};m.\u0275fac=function(i){return new(i||m)(d(D),d(q),d(B),d(O),d(L))},m.\u0275cmp=F({type:m,selectors:[["app-configSucursal"]],standalone:!0,features:[T],decls:34,vars:15,consts:[[1,"text-sm","gsap-contenido","mt-10"],[1,"w-11/12","md:w-1/3","mx-auto","mt-2","border-gray-400","p-2"],[1,"p-2","border","border-gray-400","bg-gray-100","text-center","font-semibold","text-md","md:text-xl"],[1,"mt-2"],[1,"font-semibold"],[1,"text-red-500"],["type","text","placeholder","Ej. Equinoccio Technology",1,"input-generico","w-full","mt-2",3,"disabled","ngModel","keyup.enter","ngModelChange"],["type","text","placeholder","Ej. Sucursal principal",1,"input-generico","w-full","mt-2",3,"disabled","ngModel","keyup.enter","ngModelChange"],["type","text","placeholder","Ej. 9 de Julio 911",1,"input-generico","w-full","mt-2",3,"disabled","ngModel","keyup.enter","ngModelChange"],["type","text","placeholder","Ej. 2664869642",1,"input-generico","w-full","mt-2",3,"disabled","ngModel","keyup.enter","ngModelChange"],[1,"p-2","border","w-max","my-2","rounded","border-gray-400","shadow"],["alt","LogoEmpresa.png",1,"w-40","my-4",3,"src"],["type","file","placeholder","Ej. Equinoccio Technology",1,"w-full","mt-2",3,"ngModel","ngClass","change","ngModelChange"],["class","boton-eliminar mt-2 px-2 py-1 flex items-center",3,"click",4,"ngIf"],["class","boton-editar w-full mt-4",3,"click",4,"ngIf"],[1,"boton-eliminar","mt-2","px-2","py-1","flex","items-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18 18 6M6 6l12 12"],[1,"ml-1"],[1,"boton-editar","w-full","mt-4",3,"click"]],template:function(i,e){i&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),l(4," Configuraciones de sucursal "),r(),t(5,"div",3)(6,"div")(7,"p",4)(8,"span",5),l(9," * "),r(),l(10," Empresa "),r(),t(11,"input",6),p("keyup.enter",function(){return e.actualizarConfiguraciones()})("ngModelChange",function(a){return e.configGeneralForm.nombreEmpresa=a}),r()(),t(12,"div",3)(13,"p",4)(14,"span",5),l(15," * "),r(),l(16," Sucursal "),r(),t(17,"input",7),p("keyup.enter",function(){return e.actualizarConfiguraciones()})("ngModelChange",function(a){return e.configGeneralForm.nombreSucursal=a}),r()(),t(18,"div",3)(19,"p",4),l(20," Domicilio "),r(),t(21,"input",8),p("keyup.enter",function(){return e.actualizarConfiguraciones()})("ngModelChange",function(a){return e.configGeneralForm.domicilioSucursal=a}),r()(),t(22,"div",3)(23,"p",4),l(24," Telefono "),r(),t(25,"input",9),p("keyup.enter",function(){return e.actualizarConfiguraciones()})("ngModelChange",function(a){return e.configGeneralForm.telefonoSucursal=a}),r()(),t(26,"div",3)(27,"p",4),l(28," Logo de empresa "),r(),t(29,"div",10),b(30,"img",11),r(),t(31,"input",12),p("change",function(a){return e.capturarImagen(a)})("ngModelChange",function(a){return e.file=a}),r(),_(32,H,5,0,"button",13),r(),_(33,J,2,0,"button",14),r()()()()),i&2&&(u(11),c("disabled",!e.permiso_escritura)("ngModel",e.configGeneralForm.nombreEmpresa),u(6),c("disabled",!e.permiso_escritura)("ngModel",e.configGeneralForm.nombreSucursal),u(4),c("disabled",!e.permiso_escritura)("ngModel",e.configGeneralForm.domicilioSucursal),u(4),c("disabled",!e.permiso_escritura)("ngModel",e.configGeneralForm.telefonoSucursal),u(5),c("src",e.previsualizacion?e.previsualizacion:e.dataService.urlLogoEmpresa,z),u(),c("ngModel",e.file)("ngClass",x(13,K,e.file||!e.permiso_escritura)),u(),c("ngIf",e.file),u(),c("ngIf",e.permiso_escritura))},dependencies:[A,I,j,R,P,V,U],encapsulation:2});let s=m;return s})();export{se as default};
